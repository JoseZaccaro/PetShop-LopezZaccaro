if (tittleTypo.includes("Carrito")) {

  if (localStorage.getItem("itemsCarrito")) {
  let carritoSinRepetidos = []
  let main = document.getElementsByClassName("main-cart")[0]
  let tablaProductos = document.createElement("article")
  let itemsCarrito = localStorage.getItem("itemsCarrito")
  let idItems = itemsCarrito.split(",")
  let itemsNoRep = new Set(idItems)
  let totalAPagar = 0


  idItems.forEach(function (item) {
    carritoEntero.push(...(allElements.filter(elemento => elemento._id == item)))
  })

  itemsNoRep.forEach(function (item) {
    carritoSinRepetidos.push(...(allElements.filter(elemento => elemento._id == item)))
  })



  carritoEntero.forEach(producto => {
    totalAPagar += producto.precio
  })
  // if(totalAPagar != 0){
  //    totalAPagar = totalAPagar + producto.precio
  //  }else{
  //    totalAPagar = producto.precio
  //  }

  
  // let arrayRepetidos = []

  // for (let i = 0; i < carritoSinRepetidos.length; i++) {
  //   let producto1 = carritoSinRepetidos[i]
  //   producto1.vecesRepetido = 0
  //   for (let iB = 0; iB < carritoEntero.length; iB++) {
  //     let producto2 = carritoEntero[iB]

  //     if (producto1 == producto2) {
  //       producto1.vecesRepetido += 1
  //       let nombreProductoRepetido = producto1.nombre
  //         arrayRepetidos.push({
  //           vecesRepetido:producto1.vecesRepetido,
  //           productoRepetido:nombreProductoRepetido}
  //           )
  //       }
  //     }
  //   }
  
    tablaProductos.classList.add("show-table")
    tablaProductos.innerHTML = `
    <table class="table table-hover">
      <thead class="table-dark">
       <tr>
          <th>Producto</th>
          <th class="text-center">Precio Unitario </th>
          <th class="text-center">Cantidad</th>
          <th class="text-center">Total a pagar</th>
          <th></th>
       </tr>
      </thead>
      <tbody class="table-light" id="table-body">

      </tbody>
      <tfoot class="table-dark table-active">
      <tr>
      <td class="text-center">Total:</td>
        <td></td>
        <td></td>
        <td class="text-center">$ ${totalAPagar}</td>
        <td></td>
        </tr>
      </tfoot>
    </table>
  `
    main.appendChild(tablaProductos)
    carritoSinRepetidos.map(elemento =>{
      let tbody = document.getElementById("table-body")
      let tr = document.createElement("tr")
        tr.innerHTML += `
          <tr>
            <td class="producto">${elemento.nombre}</td>
            <td>$${elemento.precio}</td>
            <td>${elemento.vecesRepetido}</td>
            <td>$${elemento.vecesRepetido * elemento.precio}</td>
            <td>
            <div class="plusMinus"><img src="./assets/plus.png" class="${elemento._id}A plusMinusButton"><img src="./assets/minus.png" class="${elemento._id}B plusMinusButton" ></div>
            </td>
            
          </tr>
          `
        tbody.appendChild(tr)

        let botonA = document.getElementsByClassName(elemento._id + "A")[0]
        let botonB = document.getElementsByClassName(elemento._id+"B")[0]
        
        botonA.addEventListener("click",(e)=>{
          // console.log(e.target.classList[0].slice(0,-1))
          let productoAInsertar = e.target.classList[0].slice(0,-1)
          idItems.push(productoAInsertar)
          
          localStorage.setItem("itemsCarrito",idItems)
          
          location.reload()



        })

        botonB.addEventListener("click",(e)=>{
          // console.log(e.target.classList[0].slice(0,-1))
          let productoAQuitar = e.target.classList[0].slice(0,-1)
          let ordenar = [...idItems]
          
          ordenar.sort((a,b)=>a-b);
          console.log(ordenar)
          let indice = ordenar.indexOf(productoAQuitar)

          if(indice != -1){
            ordenar.splice(indice,1)
          }
          // items.pop(productoAQuitar)

          localStorage.setItem("itemsCarrito",ordenar)
          window.location.reload()
        })

      })
    
    // console.log("items",items)
    // console.log("carrito",carrito)
    // console.log("carrito sin rep",carritoSinRepetidos)
      
    let buttons = document.createElement("div")

    let comprar = document.createElement("button")

    let limpiarCarrito = document.createElement("button")

    comprar.classList.add("btn","btn-primary")
    comprar.innerText = "Comprar"

    limpiarCarrito.classList.add("btn","btn-danger")
    limpiarCarrito.innerText = "Eliminar carrito"
    buttons.appendChild(comprar)

    buttons.appendChild(limpiarCarrito)

    buttons.classList.add("buttons-cart")
    limpiarCarrito.addEventListener("click",()=>{
      localStorage.removeItem("itemsCarrito")
      window.location.reload()
    })
    // comprar.addEventListener("click", ()=> {
    //   main.innerHTML = `
    //   <div class="gracias">

    //   <h1>Muchas gracias por su compra!</h1>
    //   <div> </div>
    //   </div>
    //   `
    // })
    main.appendChild(buttons)

  } else {


   let main = document.getElementsByClassName("main-cart")[0]
    let noItems = document.createElement("div")
    noItems.classList.add("noItems")
    noItems.innerHTML = `<h1> No hay productos en el carrito!.</h1>` 
    main.appendChild(noItems)
    
  }
}